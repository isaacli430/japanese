#include <stdint.h>

const unsigned char *ALLOWED_HIRAGANA_WORDS[] = {"かぎり", "の", "は"};

const uint32_t ALL_KANJI[] = {14910098,14989440,14989441,14989443,14989447,14989448,14989449,14989450,14989451,14989453,14989454,14989460,14989462,14989464,14989465,14989473,14989478,14989485,14989490,14989496,14989497,14989499,14989500,14989701,14989711,14989719,14989721,14989725,14989726,14989745,14989747,14989758,14989952,14989958,14989960,14989961,14989963,14989964,14989970,14989972,14989973,14989980,14989985,14989988,14989995,14989996,14989997,14990010,14990209,14990218,14990219,14990223,14990229,14990230,14990232,14990233,14990243,14990244,14990245,14990254,14990256,14990258,14990262,14990267,14990465,14990478,14990479,14990480,14990481,14990490,14990493,14990511,14990516,14990520,14990522,14990524,14990726,14990733,14990734,14990735,14990736,14990739,14990741,14990745,14990748,14990771,14990773,14990783,14990987,14990989,14991003,14991005,14991009,14991022,14991023,14991029,14991030,14991039,14991234,14991235,14991242,14991255,14991261,14991265,14991278,14991283,14991285,14991288,14991290,15040649,15040651,15040653,15040658,15040665,15040671,15040675,15040676,15040683,15040697,15040905,15040911,15040924,15040933,15040948,15040949,15040950,15041165,15041169,15041176,15041177,15041196,15041202,15041205,15041207,15041214,15041413,15041421,15041423,15041429,15041434,15041447,15041664,15041668,15041682,15041695,15041706,15041923,15041924,15041925,15041926,15041928,15041929,15041931,15041933,15041936,15041946,15041957,15041960,15041963,15041964,15041965,15041969,15041973,15041975,15041976,15041980,15042181,15042182,15042186,15042189,15042194,15042199,15042201,15042208,15042213,15042220,15042230,15042231,15042436,15042438,15042445,15042461,15042465,15042470,15042486,15042488,15042489,15042490,15042688,15042691,15042694,15042695,15042696,15042698,15042705,15042711,15042717,15042724,15042725,15042729,15042736,15042742,15042743,15042744,15042745,15042746,15042747,15042951,15042954,15042957,15042966,15042971,15042973,15042979,15042980,15042991,15042992,15042994,15042997,15043207,15043227,15043231,15043232,15043235,15043241,15043242,15043249,15043252,15043257,15043262,15043459,15043461,15043463,15043465,15043477,15043480,15043481,15043485,15043487,15043490,15043492,15043495,15043506,15043518,15043714,15043717,15043734,15043735,15043744,15043769,15043770,15043771,15043775,15043969,15043971,15043975,15043976,15043978,15043985,15043986,15043987,15043988,15043991,15043992,15043994,15044000,15044016,15044017,15044019,15044020,15044021,15044024,15044228,15044248,15044250,15044255,15044275,15044283,15044482,15044488,15044490,15044491,15044492,15044493,15044494,15044500,15044502,15044503,15044505,15044515,15044516,15044517,15044523,15044524,15044527,15044528,15044529,15044530,15044531,15044535,15044536,15044740,15044744,15044745,15044748,15044749,15044750,15044751,15044752,15044753,15044763,15044767,15044774,15044779,15044792,15044793,15044994,15045000,15045001,15045002,15045032,15045034,15045043,15045052,15045053,15045260,15045298,15045309,15045504,15045505,15045537,15045554,15045562,15045764,15045766,15045767,15045776,15045807,15045809,15045822,15046022,15046031,15046035,15046276,15046281,15046298,15046300,15046301,15046313,15046314,15046315,15046326,15046533,15046563,15046790,15046833,15046834,15047080,15047092,15047303,15047578,15047579,15047582,15047584,15047587,15047600,15047602,15047603,15047610,15047613,15047823,15047826,15047839,15047847,15047848,15047856,15048066,15048071,15048074,15048081,15048106,15048322,15048331,15048355,15048587,15048590,15048607,15048631,15048633,15048634,15048636,15048832,15048834,15048837,15048838,15048853,15048868,15048874,15048881,15048884,15049088,15049089,15049098,15049105,15049108,15049111,15049114,15049118,15049121,15049129,15049150,15049347,15049363,15049367,15049372,15049384,15049395,15049406,15049601,15049607,15049610,15049612,15049643,15049646,15049648,15049649,15049650,15049865,15049871,15049877,15049878,15049882,15049884,15049890,15049895,15049897,15049898,15049899,15049902,15049905,15050119,15050120,15050121,15050127,15050129,15050132,15050149,15050152,15050154,15050158,15050163,15050164,15050173,15050370,15050371,15050372,15050378,15050390,15050393,15050405,15050408,15050412,15050425,15050427,15050633,15050635,15050643,15050644,15050667,15050683,15050687,15050881,15050904,15050912,15050927,15051142,15051162,15051174,15051199,15051410,15051419,15051649,15051657,15051660,15051681,15051938,15052176,15052180,15052183,15052184,15052189,15052195,15052196,15052198,15052203,15052421,15052423,15052424,15052425,15052428,15052439,15052440,15052441,15052442,15052443,15052444,15052445,15052447,15052450,15052451,15052452,15052462,15052464,15052467,15052468,15052469,15052470,15052473,15052479,15052674,15052676,15052678,15052684,15052690,15052699,15052701,15052703,15052705,15052711,15052713,15052718,15052728,15052730,15052734,15052735,15052929,15052930,15052932,15052934,15052937,15052938,15052939,15052942,15052943,15052945,15052954,15052977,15052986,15052987,15052988,15052989,15052990,15052991,15053184,15053189,15053192,15053194,15053195,15053205,15053214,15053220,15053221,15053231,15053233,15053456,15053473,15053481,15053484,15053491,15053496,15053728,15053729,15053744,15053750,15053959,15053966,15053974,15053993,15054224,15054749,15054750,15054753,15054755,15054757,15054758,15054759,15054760,15054766,15054769,15054779,15054782,15054978,15054979,15054982,15054988,15055005,15055013,15055019,15055021,15055023,15055024,15055027,15055032,15055037,15055237,15055253,15055267,15055282,15055283,15055284,15055288,15055289,15055291,15055292,15055293,15055294,15055489,15055491,15055498,15055503,15055509,15055511,15055516,15055526,15055527,15055531,15055533,15055542,15055543,15055544,15055747,15055753,15055754,15055798,15055799,15055802,15056001,15056004,15056010,15056015,15056016,15056019,15056020,15056021,15056031,15056037,15056038,15056039,15056049,15056053,15056055,15056062,15056275,15056281,15056290,15056297,15056299,15056304,15056305,15056313,15056316,15056512,15056513,15056516,15056517,15056523,15056524,15056528,15056530,15056531,15056535,15056545,15056553,15056554,15056558,15056563,15056564,15056569,15056771,15056773,15056780,15056781,15056791,15056792,15056793,15056796,15056800,15056811,15056821,15106194,15106198,15106205,15106208,15106213,15106215,15106216,15106218,15106443,15106448,15106450,15106467,15106469,15106472,15106473,15106477,15106479,15106485,15106708,15106719,15106720,15106723,15106726,15106729,15106730,15106738,15106748,15106949,15106961,15106972,15106983,15106984,15106992,15106995,15107201,15107209,15107215,15107226,15107227,15107231,15107460,15107464,15107467,15107468,15107470,15107477,15107490,15107491,15107496,15107502,15107504,15107510,15107714,15107726,15107748,15107751,15107753,15107756,15107762,15107766,15107774,15107975,15107984,15108018,15108024,15108240,15108241,15108242,15108250,15108262,15108271,15108276,15108280,15108283,15108287,15108480,15108487,15108489,15108491,15108493,15108499,15108501,15108529,15108534,15108537,15108543,15108736,15108740,15108746,15108753,15108757,15108759,15108760,15108764,15108766,15108779,15108785,15108789,15108793,15108796,15108797,15108997,15109001,15109005,15109008,15109010,15109011,15109016,15109017,15109019,15109021,15109024,15109025,15109036,15109037,15109043,15109046,15109047,15109054,15109249,15109255,15109265,15109273,15109279,15109288,15109291,15109295,15109311,15109513,15109525,15109527,15109532,15109544,15109550,15109563,15109763,15109768,15109772,15109778,15109784,15109787,15109793,15109794,15109797,15109799,15109800,15109802,15109810,15110031,15110032,15110042,15110043,15110049,15110062,15110068,15110074,15110285,15110316,15110317,15110330,15110334,15110530,15110552,15110569,15110575,15110787,15110820,15110830,15110834,15111041,15111053,15111078,15111084,15111343,15111353,15111355,15111358,15111359,15111557,15111567,15111569,15111575,15111577,15111586,15111587,15111596,15111604,15111605,15111607,15111815,15111817,15111822,15111825,15111831,15111833,15111836,15111844,15111845,15111852,15111853,15111856,15111865,15111869,15112069,15112075,15112079,15112087,15112098,15112101,15112102,15112103,15112104,15112105,15112108,15112122,15112326,15112327,15112334,15112339,15112340,15112351,15112352,15112357,15112359,15112360,15112365,15112367,15112380,15112578,15112617,15112622,15112623,15112628,15112630,15112833,15112839,15112849,15112854,15112855,15112870,15112875,15112878,15112884,15113095,15113110,15113116,15113138,15113140,15113144,15113145,15113149,15113151,15113344,15113352,15113353,15113357,15113365,15113367,15113371,15113373,15113375,15113384,15113386,15113387,15113388,15113389,15113393,15113396,15113402,15113405,15113609,15113616,15113617,15113631,15113633,15113637,15113647,15113649,15113662,15113663,15113872,15113877,15113879,15113882,15113884,15113885,15113888,15113890,15113903,15113910,15114116,15114128,15114131,15114132,15114161,15114163,15114165,15114171,15114175,15114371,15114372,15114387,15114401,15114410,15114424,15114425,15114428,15114429,15114625,15114627,15114632,15114641,15114652,15114655,15114885,15114903,15114920,15114928,15115140,15115147,15115154,15115162,15115167,15115182,15115194,15115397,15115405,15115406,15115420,15115693,15115701,15115703,15115708,15115709,15115906,15116171,15116184,15116221,15116441,15116449,15116457,15116458,15116473,15116683,15116703,15117444,15117472,15117473,15117479,15117490,15117498,15117502,15117708,15117715,15117730,15117731,15117734,15117737,15117743,15117747,15117748,15117755,15117961,15117962,15117963,15117974,15118004,15118005,15118010,15118011,15118015,15118208,15118221,15118222,15118226,15118228,15118235,15118479,15118481,15118487,15118516,15118519,15118520,15118526,15118721,15118722,15118734,15118743,15118746,15118751,15118752,15118768,15118778,15118781,15118979,15118984,15118998,15119001,15119009,15119010,15119027,15119032,15119033,15119035,15119036,15119039,15119233,15119241,15119242,15119244,15119253,15119265,15119266,15119267,15119269,15119272,15119280,15119283,15119499,15119511,15119518,15119525,15119530,15119547,15119550,15119745,15119748,15119749,15119772,15119782,15119786,15119790,15119796,15119799,15119800,15120008,15120025,15120047,15120050,15120060,15120273,15120289,15120299,15120305,15120311,15120315,15120517,15120519,15120520,15120521,15120523,15120531,15120539,15120545,15120550,15120553,15120556,15120559,15120790,15120807,15120815,15120830,15120831,15121024,15121040,15121046,15121053,15121078,15121082,15121285,15121291,15121297,15121309,15121310,15121332,15121537,15121538,15121542,15121551,15121556,15121568,15121570,15121579,15121580,15121592,15121812,15121820,15121823,15121828,15121838,15121840,15122052,15122304,15122305,15122307,15122347,15122351,15171756,15172011,15172015,15172016,15172029,15172233,15172234,15172238,15172269,15172281,15172282,15172488,15172769,15172774,15172790,15172796,15173006,15173017,15173031,15173033,15173038,15173258,15173279,15173297,15173507,15173541,15173766,15173802,15173813,15173814,15173821,15174023,15174024,15174041,15174043,15174055,15174057,15174066,15174073,15174304,15174316,15174319,15174326,15174530,15174553,15174569,15174572,15174573,15174811,15174815,15174827,15174830,15174838,15174847,15175044,15175075,15175090,15175300,15175303,15175305,15175307,15175337,15175565,15175584,15175597,15175614,15175811,15175814,15175860,15176096,15176323,15176359,15176368,15176381,15176614,15176630,15176856,15176858,15176863,15176867,15176872,15176880,15176881,15176882,15176883,15176887,15176890,15176891,15177100,15177103,15177105,15177108,15177113,15177116,15177117,15177125,15177130,15177136,15177139,15177151,15177358,15177361,15177387,15177394,15177406,15177605,15177607,15177621,15177624,15177627,15177634,15177641,15177652,15177869,15178114,15178130,15178134,15178170,15178171,15178173,15178174,15178372,15178374,15178375,15178414,15178431,15178630,15178634,15178647,15178651,15178655,15178659,15178660,15178670,15178674,15178676,15178680,15178686,15178881,15178889,15178891,15178892,15178912,15178938,15178940,15179136,15179169,15179171,15179174,15179436,15179437,15179443,15179675,15179682,15179685,15179693,15179695,15179699,15179906,15179924,15179925,15179954,15179956,15180189,15180203,15180204,15180417,15180433,15180474,15180673,15180712,15180929,15180942,15180986,15180988,15180990,15181192,15181193,15181206,15181213,15181214,15181221,15181224,15181229,15181441,15181445,15181453,15181455,15181696,15181697,15181707,15181713,15181714,15181720,15181727,15181737,15181744,15181755,15181963,15181966,15181978,15181998,15182002,15182012,15182013,15182015,15182208,15182210,15182221,15182223,15182251,15182260,15182262,15182266,15182465,15182467,15182482,15182483,15182495,15182510,15182511,15182731,15182748,15182752,15182757,15182767,15182774,15182777,15182993,15183003,15183014,15183020,15183238,15183241,15183243,15183250,15183252,15183254,15183495,15183499,15183511,15183521,15183537,15183544,15183744,15183748,15183753,15183780,15184033,15184063,15184269,15184288,15184307,15184521,15184523,15184530,15184535,15184536,15184539,15184551,15184574,15184790,15184807,15184824,15184827,15184830,15185024,15185028,15185029,15185035,15185037,15185044,15185049,15185050,15185051,15185056,15185057,15185058,15185067,15185071,15185072,15185075,15185081,15185082,15185282,15185284,15185292,15185296,15185310,15185313,15185318,15185329,15185333,15185334,15185337,15185561,15185562,15185581,15185585,15185586,15185595,15185599,15185802,15185807,15185809,15185810,15185818,15185824,15185832,15185833,15185839,15185844,15185851,15186049,15186052,15186075,15186086,15186091,15186094,15186110,15186305,15186314,15186324,15186325,15186349,15186352,15187126,15187370,15187374,15187376,15187378,15187381,15187383,15187589,15187594,15187598,15187614,15187620,15187624,15187625,15187645,15187841,15187852,15187858,15187899,15187900,15237249,15237251,15237253,15237264,15237269,15237271,15237299,15237526,15237534,15237556,15237559,15237769,15237772,15237782,15237784,15237789,15237793,15237794,15237797,15237801,15237802,15237807,15237810,15237818,15238019,15238022,15238028,15238030,15238046,15238068,15238072,15238077,15238274,15238277,15238279,15238280,15238282,15238298,15238321,15238323,15238542,15238544,15238549,15238571,15238576,15238584,15238585,15238586,15238810,15238812,15238813,15238824,15238835,15239046,15239059,15239075,15239080,15239082,15239085,15239091,15239092,15239100,15239304,15239308,15239310,15239319,15239326,15239327,15239338,15239340,15239350,15239351,15239353,15239559,15239590,15239599,15239602,15239606,15239819,15239837,15239855,15239857,15239859,15239864,15239869,15240087,15240091,15240101,15240102,15240113,15240322,15240334,15240360,15240374,15240585,15240594,15240600,15240631,15241098,15241100,15241107,15241116,15241135,15241358,15241405,15241609,15241623,15241627,15241644,15241912,15242116,15242123,15242385,15242421,15242429,15242884,15242918,15242922,15242923,15242924,15243149,15243172,15243177,15243195,15243662,15243664,15243674,15243676,15243678,15243691,15243705,15243914,15243925,15244167,15244173,15244206,15244418,15244444,15244941,15245696,15245702,15245708,15245715,15245719,15245723,15245725,15245729,15245731,15245736,15245744,15245751,15245963,15245974,15245995,15246209,15246210,15246213,15246223,15246229,15246236,15246264,15246269,15246270,15246471,15246480,15246482,15246751,15246770,15246783,15246977,15246982,15246983,15246987,15246991,15246998,15247002,15247015,15247018,15247027,15247250,15247267,15247270,15247488,15247490,15247491,15247496,15247502,15247507,15247511,15247512,15247519,15247530,15247533,15247537,15247539,15247540,15247546,15247548,15247760,15247764,15247765,15247774,15247776,15247779,15247782,15247785,15247790,15247792,15247793,15247794,15247795,15248007,15248009,15248012,15248013,15248019,15248021,15248024,15248030,15248032,15248036,15248044,15248045,15248048,15248050,15248063,15248263,15248267,15248278,15248294,15248295,15248301,15248302,15248312,15248318,15248512,15248513,15248516,15248526,15248537,15248539,15248541,15248545,15248569,15248792,15248796,15248806,15248816,15248818,15248823,15249591,15249798,15249802,15249818,15249825,15249834,15250060,15250077,15250078,15250080,15250081,15250082,15250087,15250088,15250089,15250090,15250091,15250092,15250095,15250100,15250103,15250104,15250107,15250108,15250111,15250304,15250306,15250307,15250308,15250311,15250314,15250323,15250331,15250332,15250334,15250336,15250338,15250342,15250346,15250349,15250364,15250568,15250852,15250854,15250864,15250868,15250871,15251077,15251082,15251107,15251123,15251357,15251361,15251375,15251379,15251381,15251594,15251599,15251626,15251892,15252109,15252139,15252362,15252364,15252365,15252370,15252383,15252386,15252408,15252413,15252611,15252617,15252637,15252649,15252650,15252664,15252868,15253147,15253150,15253155,15253169,15253170,15253178,15253180,15253381,15253390,15253393,15253396,15253419,15253421,15253424,15253431,15253437,15302784,15302785,15302787,15302790,15302799,15302800,15302803,15302804,15302810,15302813,15302815,15302816,15302819,15302830,15302833,15302834,15302840,15303042,15303045,15303047,15303050,15303051,15303053,15303054,15303059,15303060,15303061,15303068,15303072,15303073,15303075,15303081,15303085,15303086,15303093,15303095,15303096,15303098,15303103,15303300,15303331,15303334,15303338,15303352,15303562,15303566,15303585,15303592,15303597,15303605,15303607,15303613,15304076,15304077,15304078,15304082,15304084,15304098,15304106,15304108,15304117,15304119,15304120,15304338,15304348,15304376,15304583,15304584,15304588,15304589,15304590,15304591,15304593,15304604,15304605,15304611,15304845,15304884,15305092,15305115,15305122,15305137,15305344,15305347,15305349,15305368,15305389,15305645,15305651,15305660,15305888,15305894,15305900,15305902,15305903,15305906,15306123,15306139,15306165,15306380,15306390,15306414,15306657,15306904,15307153,15308215,15308416,15308425,15308427,15308433,15308435,15308451,15308453,15308466,15308679,15308696,15308956,15308970,15308978,15308987,15309188,15309197,15309200,15309211,15309218,15309219,15309220,15309221,15309226,15309232,15309235,15309237,15309238,15309240,15309242,15309245,15309445,15309446,15309450,15309454,15309455,15309460,15309465,15309467,15309468,15309472,15309475,15309495,15309499,15309700,15309701,15309702,15309703,15309708,15309713,15309730,15309731,15309736,15309738,15309744,15309746,15309750,15309751,15309755,15309952,15309959,15309962,15309980,15309991,15310002,15310226,15310233,15310238,15310242,15310249,15310260,15310739,15310771,15310779,15310783,15310978,15310979,15310981,15310982,15310984,15310992,15310993,15310994,15310995,15311000,15311020,15311021,15311035,15311036,15311244,15311245,15311246,15311252,15311253,15311256,15311262,15311271,15311528,15311771,15311775,15311778,15311791,15311794,15311804,15311805,15311806,15312005,15312010,15312012,15312019,15312040,15312534,15312537,15312556,15312772,15312773,15312774,15312784,15312786,15313038,15313042,15313043,15313072,15313306,15313576,15313592,15313796,15313816,15313834,15314097,15314108,15314306,15314309,15314324,15314330,15314606,15314856,15315877,15315892,15316623,15316660,15317439,15317651,15317655,15317670,15317690,15317691,15317892,15317906,15317913,15318163,15318203,15318434};